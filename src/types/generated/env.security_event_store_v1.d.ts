/* tslint:disable */
/* eslint-disable */
/**
 * This file was automatically generated by scripts/gen_types.ts.
 * Do not edit manually. Update JSON Schemas and rerun npm run gen:types.
 */

/**
 * Core security episode schema for MOVA: records a security-relevant event with policy reference, severity, and recommended/actual actions.
 */
export type DsSecurityEventEpisodeCoreV1 = DsMovaEpisodeCoreV1 & {
  /**
   * Episode type must indicate a security event. Convention: security_event[/subtype], where subtype normally matches a security_event_type id.
   */
  episode_type: string;
  /**
   * Concrete type of security event. Should use an id from global.security_catalog_v1.security_event_type[*].id (e.g. prompt_injection_suspected), or a namespaced custom type (vendorX:custom_event) if extended.
   */
  security_event_type: string;
  /**
   * High-level category for grouping security events.
   */
  security_event_category:
    | 'auth'
    | 'authorization'
    | 'policy_violation'
    | 'instruction_misuse'
    | 'data_access'
    | 'rate_limit'
    | 'config'
    | 'infrastructure'
    | 'other';
  /**
   * Severity of the event from the security perspective.
   */
  severity: 'info' | 'low' | 'medium' | 'high' | 'critical';
  /**
   * Identifier of the security policy profile that applies, e.g. mova_security_default_v1. Should match an id from global.security_catalog_v1.security_policy_profile[*].id.
   */
  policy_profile_id?: string;
  /**
   * Optional reference to the concrete policy document/rule that was triggered.
   */
  policy_ref?: {
    /**
     * Identifier or URL of the policy document.
     */
    policy_document_id?: string;
    /**
     * Identifier of the concrete rule or clause inside the policy.
     */
    rule_id?: string;
    /**
     * Version of the policy used for this evaluation.
     */
    policy_version?: string;
    [k: string]: unknown;
  };
  /**
   * Version of the MOVA security model used when producing this episode, e.g. 1.0.0. Should match the security_model_version of the referenced policy profile in global.security_catalog_v1.
   */
  security_model_version: string;
  /**
   * Where this security event came from: human_review, rule_engine, runtime_guard, external_system, other.
   */
  detection_source?: 'human_review' | 'rule_engine' | 'runtime_guard' | 'external_system' | 'other';
  /**
   * Confidence in this event being correctly detected, from 0.0 to 1.0.
   */
  detection_confidence?: number;
  /**
   * List of recommended actions in response to this security event.
   */
  recommended_actions?: {
    /**
     * Type of recommended action, e.g. log, alert, block, fallback. Should use an id from global.security_catalog_v1.security_action_type[*].id.
     */
    action_type: string;
    /**
     * Short human-readable explanation why this action is recommended.
     */
    reason?: string;
    /**
     * Relative priority of this action.
     */
    priority?: 'low' | 'medium' | 'high';
    [k: string]: unknown;
  }[];
  /**
   * List of actions that were actually taken in response to this security event.
   */
  actions_taken?: {
    /**
     * Type of action taken. Should use an id from global.security_catalog_v1.security_action_type[*].id.
     */
    action_type: string;
    /**
     * When this action was executed.
     */
    taken_at?: string;
    /**
     * Actor that executed the action (service id, user id, tool id, etc.).
     */
    actor?: string;
    /**
     * Result status of the action.
     */
    status?: 'completed' | 'failed' | 'skipped';
    /**
     * Optional human-readable details about this action.
     */
    details?: string;
    [k: string]: unknown;
  }[];
};
/**
 * Core MOVA episode schema: minimal common structure for recording a meaningful step of work.
 */
export type DsMovaEpisodeCoreV1 = DsMovaSchemaCoreV1 & {
  [k: string]: unknown;
};

/**
 * Envelope for storing a MOVA security event episode in a security log or store.
 */
export interface EnvSecurityEventStoreV1 {
  envelope_id: 'env.security_event_store_v1';
  verb: 'record';
  /**
   * Who records the event and which store receives it.
   */
  roles: {
    /**
     * Identifier of the producer of this event (service id, guard id, etc.).
     */
    producer: string;
    /**
     * Identifier of the target security store or log.
     */
    security_store: string;
  };
  event: DsSecurityEventEpisodeCoreV1;
  /**
   * Optional metadata for routing: correlation ids, partition keys, etc.
   */
  meta?: {
    [k: string]: unknown;
  };
}
/**
 * Core form for MOVA data schemas (ds.*) instances: common service fields schema_id, schema_version, meta, ext.
 */
export interface DsMovaSchemaCoreV1 {
  /**
   * Canonical schema id for this data record, e.g. ds.smartlink_config_v1. Recommended but optional.
   */
  schema_id?: string;
  /**
   * Version of the schema used when this record was produced, e.g. 1 or 1.0.0.
   */
  schema_version?: string;
  /**
   * Human- and operator-oriented metadata: title, description, tags, notes. Must not contain execution instructions for LLMs.
   */
  meta?: {
    /**
     * Short human-readable title of this record.
     */
    title?: string;
    /**
     * Longer human-readable description or notes.
     */
    description?: string;
    /**
     * Optional list of tags for searching and grouping.
     */
    tags?: string[];
    /**
     * IETF language tag describing primary human language of title/description, e.g. uk, en, de.
     */
    lang?: string;
    [k: string]: unknown;
  };
  /**
   * Machine-oriented extensions: technical flags, computed hints, links to external systems. Must not contain LLM instructions.
   */
  ext?: {
    [k: string]: unknown;
  };
  [k: string]: unknown;
}
